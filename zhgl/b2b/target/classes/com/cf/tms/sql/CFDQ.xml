<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CFDQ" >
	<!-- 查询服务套餐列表 --> 
 	<select id="selectDQ" parameterType="map" resultType="map">
		select a.code AS "code",a.name AS "name",a.net_code AS "net_code",a.s_code AS "s_code",a.zz_flag AS "zz_flag",
         a.zzts AS "zzts",a.pssx AS "pssx",a.area_lv AS "area_lv",a.jc AS "jc",a.area_flag AS "area_flag",
      (select b.net_name from net_tab b where a.net_code=b.net_code)  AS "net_name",
      (select c.name from dqlx_tab c where c.code=a.area_flag)  AS "dqlxname",
      (select d.name from area_tab d where d.code=a.s_code)  AS "s_name",
      (case when zz_flag=0 then '否'
        when zz_flag=1 then '是'
      END)  AS "zzflag_cn",a.kwbh AS "kwbh",a.yyjb AS "yyjb",a.name3 AS "name3",
      a.zz_flag_cw "zz_flag_cw",a.qp "qp_cn",a.jp "jp_cn",
      (case when a.zz_flag_cw=0 then '否'
			when a.zz_flag_cw=1 then '是'
		END) "zz_flag_cw_cn",
    a.qp "qp",a.jp "jp"
      from area_tab a
      where 1=1
		<if test="code != '' and code != null">AND code LIKE '%'||#{code}||'%'</if>
		<if test="name != '' and name != null">AND name LIKE '%'||#{name}||'%'</if>
		<if test="code2 != '' and code2 != null">AND ((code =#{code2}) OR (s_code =#{code2}))</if>
	</select> 
	 <select id="selectDQKH" parameterType="map" resultType="map">
		select a.code AS "code",a.name AS "name",a.net_code AS "net_code",a.s_code AS "s_code",a.zz_flag AS "zz_flag",
	       a.zzts AS "zzts",a.pssx AS "pssx",a.area_lv AS "area_lv",a.jc AS "jc",a.area_flag AS "area_flag",
			(select b.net_name from net_tab b where a.net_code=b.net_code)  AS "net_name",
			(select c.name from dqlx_tab c where c.code=a.area_flag)  AS "dqlxname",
			(select d.name from area_tab d where d.code=a.s_code)  AS "s_name",
			(case when zz_flag=0 then '否'
				when zz_flag=1 then '是'
			END)  AS "zzflag_cn",
	    a.kwbh AS "kwbh",a.yyjb AS "yyjb",a.name3 AS "name3",
	    a.sndhsj AS "sndhsj",a.zzdhsj AS "zzdhsj",a.qsscts AS "qsscts"
		from area_tab a
		where 1=1
		<if test="code != '' and code != null">AND code LIKE '%'||#{code}||'%'</if>
		<if test="name != '' and name != null">AND name LIKE '%'||#{name}||'%'</if>
		<if test="code2 != '' and code2 != null">AND ((code =#{code2}) OR (s_code =#{code2}))</if>
	</select> 
	 <select id="selectDQTREE" parameterType="map" resultType="map">
		select a.code AS "id",a.name AS "text",a.s_code AS "s_id",a.area_lv AS "lv",
		(select count(1) from area_tab where s_code=a.code) AS "mjbj" 
		from area_tab a 
		where 1=1
		<if test="lv != '' and lv != null">AND a.area_lv=#{lv}</if>
		<if test="s_code != '' and s_code != null">AND a.s_code=#{s_code}</if>
		<if test="code != '' and code != null">AND code LIKE '%'||#{code}||'%'</if>
		<if test="name != '' and name != null">AND name LIKE '%'||#{name}||'%'</if>
	</select>
	<select id="selectDQLX" parameterType="map" resultType="map">
		select code AS "code",name AS "name"
		from dqlx_tab
	</select> 

</mapper> 