<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CFRY" >
	<!--查询服务套餐列表  -->
	<select id="selectRY" parameterType="map" resultType="map">
		select a.peop_code AS "peop_code",a.peop_name AS "peop_name",a.dept_code AS "dept_code",a.p_code AS "p_code",a.net_code AS "net_code",a.tel AS "tel",
	    to_char(a.birthday, 'yyyy-mm-dd') AS "birthday",a.age AS "age",
	    a.edu AS "edu",a.addr AS "addr",a.sfzh AS "sfzh",to_char(a.lyrq, 'yyyy-mm-dd') AS "lyrq",to_char(a.czrq, 'yyyy-mm-dd') AS "czrq",
	    a.intro_code AS "intro_code",a.bc AS "bc",a.cblx AS "cblx",a.sfzyxq AS "sfzyxq",a.rylx AS "rylx",
	    a.yhkh AS "yhkh",a.zz_flag AS "zz_flag",a.photo AS "photo",a.sex AS "sex",a.email AS "email",a.yxbj AS "yxbj",
	    (select b.name from position_tab b where b.code=a.p_code) AS "p_name",
	    (select c.dept_name from dept_tab c where c.dept_code=a.dept_code) AS "dept_name",
	    (select d.net_name from net_tab d where d.net_code=a.net_code) AS "net_name",
	    (select e.peop_name from peop_tab e where e.peop_code=a.intro_code) AS "intro_name" ,
	    (case when zz_flag=0 then '是'
	        when zz_flag=1 then '否'
	    END) AS "zz_flag_cn",
	    (case when bc=0 then '白班'
	      when bc=1 then '夜班'
	      when bc=2 then '倒班'
	    END) AS "bc_cn",
	    a.cblx AS "cblx",a.bxzl AS "bxzl",a.xz AS "xz",
	    (case when sex=0 then '男'
	      when sex=1 then '女'
	    END) AS "sex_cn",a.wx AS "wx"
	    from peop_tab a
	    where 1 = 1
		<if test="peop_code != '' and peop_code != null">AND peop_code LIKE '%'||#{peop_code}||'%'</if>
		<if test="peop_name != '' and peop_name != null">AND peop_name LIKE '%'||#{peop_name}||'%'</if>
		<if test="net_code != '' and net_code != null">AND net_code = #{net_code}</if>
		<if test="dept_code != '' and dept_code != null">AND dept_code LIKE #{dept_code}||'%'</if>
		order by peop_code
 	</select>
 	<select id="selectZW" parameterType="map" resultType="map">
		select code AS "p_code",name AS "p_name"
		from position_tab
		order by code
 	</select>
 	<select id="selectWD" parameterType="map" resultType="map">
		select net_code AS "code",net_name AS "name",s_code AS "s_code"
		from net_tab
		where net_name !='总部' and dqzt=0
 	</select>
 	<select id="selectWD2" parameterType="map" resultType="map">
		select net_code AS "code",net_name AS "name",s_code AS "s_code"
		from net_tab
		where net_name ='总部' and dqzt=0
 	</select>
 	<select id="selectBM" parameterType="map" resultType="map">
		select dept_code AS "code",dept_name AS "name",s_code AS "s_code"
		from dept_tab
		where 1=1
		AND substr(dept_code,1,2)='10'
		order by dept_code
 	</select>
 	<select id="selectBM2" parameterType="map" resultType="map">
		select a.dept_code AS "code",a.dept_name AS "name",a.s_code AS "s_code"
		from dept_tab a,net_tab b
		where substr(dept_code,1,2)=b.ssbm 
		<if test="net_code != '' and net_code != null">AND b.net_code=#{net_code}</if>
		order by a.dept_code
 	</select>
 	<select id="selectBM3" parameterType="map" resultType="map">
 		select a.dept_code AS "code",a.dept_name AS "name",a.s_code AS "s_code"
		from dept_tab a
		order by a.dept_code
	</select>	
 	<select id="selectJSR" parameterType="map" resultType="map">
		select peop_code AS "peop_code",peop_name||'('||peop_code||')' AS "peop_name"
        from peop_tab
        where zz_flag=0
 	</select>
 	<select id="selectRYBH" parameterType="map" resultType="map">
		select NVL(max(peop_code)+1,substr(#{net_code},1,4)||'00001') AS "rybh" 
		from peop_tab 
		where substr(peop_code,1,4) = substr(#{net_code},1,4) 
 	</select>
</mapper>