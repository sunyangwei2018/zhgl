<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CFWD" >
	<!-- 查询服务套餐列表 --> 
 	<select id="selectWD" parameterType="map" resultType="map">
		select a.net_code AS "net_code",a.net_name AS "net_name",a.wdlx AS "wdlx",a.fzr AS "fzr",a.dqzt AS "dqzt",
	       a.glz AS "glz",a.jswd AS "jswd",a.tel AS "tel",a.addr AS "addr",a.net_lv AS "net_lv",a.s_code AS "s_code",
	       a.sjwd AS "sjwd",a.ssbm AS "ssbm",
	    (select b.peop_name from peop_tab b where b.peop_code=a.fzr)  AS "peop_name",
	    (select c.name from wlglz_tab c where c.code=a.glz)  AS "glz_name",
	    (select d.net_name from net_tab d where d.net_code=a.jswd)  AS "jswd_name",
	    (select e.net_name from net_tab e where e.net_code=a.s_code)  AS "s_name",
	    (case when wdlx=1 then '加盟'
	      when wdlx=2 then '直营'
	      when wdlx=3 then '承运商'
	    END)  AS "wdlx_cn",
	    (case when dqzt=0 then '运营中'
	      when dqzt=1 then '已停用'
	      when dqzt=2 then '已停网'
	    END)  AS "dqzt_cn",a.v8name AS "v8name",decode(a.j_code,null,null,a.j_code||','|| a.w_code）"jwd",
      a.fbzx "fbzx",
      (case when a.fbzx=0 then '否'
			when a.fbzx=1 then '是'
		END) "fbzx_cn",
    a.mrdq "mrdq",a.wdlb "wdlb",
    (select name from area_tab where a.mrdq=code) "mrdq_cn",
    a.wdlb "wdlb_cn",a.sd "sd",a.fptt "fptt",a.yhht "yhht",a.yhzh "yhzh",a.khh "khh",a.khhdz "khhdz" ,
    a.sd "sd_cn",a.fptt "fptt_cn",a.yhht "yhht_cn",a.yhzh "yhzh_cn",a.khh "khh_cn",a.khhdz "khhdz_cn"    
	    from net_tab a
	    where 1 = 1
		<if test="net_code != '' and net_code != null">AND a.net_code LIKE '%'||#{net_code}||'%'</if>
		<if test="net_name != '' and net_name != null">AND a.net_name LIKE '%'||#{net_name}||'%'</if>
		<if test="peop_name != '' and peop_name != null">AND a.peop_name LIKE '%'||#{peop_name}||'%'</if>
		<if test="sjwd != '' and sjwd != null">AND a.sjwd=#{sjwd}</if>
		<if test="dqzt != '' and dqzt != null">AND a.dqzt= #{dqzt}</if>
 	</select> 

 	<select id="selectSJDM" parameterType="map" resultType="map">
		select net_code AS "net_code",net_name AS "net_name",net_lv AS "net_lv"
		from net_tab where dqzt=0
 	</select> 
 	<select id="selectGLZ" parameterType="map" resultType="map">
		select code AS "code",name AS "name"
		from wlglz_tab
 	</select> 
 
 	<select id="selectSXSJ" parameterType="map" resultType="map">
		select a.net_code AS "net_code",a.net_name AS "net_name",a.wdlx AS "wdlx",a.fzr AS "fzr",a.dqzt AS "dqzt",
	       a.glz AS "glz",a.jswd AS "jswd",a.tel AS "tel",a.addr AS "addr",a.net_lv AS "net_lv",a.s_code AS "s_code",
			   a.sjwd AS "sjwd",a.ssbm AS "ssbm",
			(select b.peop_name from peop_tab b where b.peop_code=a.fzr)  AS "peop_name",
	    (select c.name from wlglz_tab c where c.code=a.glz)  AS "glz_name",
	    (select d.net_name from net_tab d where d.net_code=a.jswd)  AS "jswd_name",
	    (select e.net_name from net_tab e where e.net_code=a.s_code)  AS "s_name",
	    (case when wdlx=1 then '加盟'
	      when wdlx=2 then '直营'
	      when wdlx=3 then '承运商'
	    END)  AS "wdlx_cn",
	    (case when dqzt=0 then '运营中'
	      when dqzt=1 then '已停用'
	      when dqzt=2 then '已停网'
	    END)  AS "dqzt_cn",a.v8name AS "v8name",decode(a.j_code,null,null,a.j_code||','|| a.w_code）"jwd",a.mrdq "mrdq",a.wdlb "wdlb",a.sd "sd",a.sd "sd_cn",
    (select name from area_tab where a.mrdq=code) "mrdq_cn",
    a.wdlb "wdlb_cn",a.sd "sd",a.fptt "fptt",a.yhht "yhht",a.yhzh "yhzh",a.khh "khh",a.khhdz "khhdz" ,
    a.sd "sd_cn",a.fptt "fptt_cn",a.yhht "yhht_cn",a.yhzh "yhzh_cn",a.khh "khh_cn",a.khhdz "khhdz_cn"
	    from net_tab a
	    where 1 = 1
	    AND ((net_code =#{net_code}) OR (s_code =#{net_code}))
		<if test="dqzt != '' and dqzt != null">AND dqzt= #{dqzt}</if>
	</select>   
 
 	<select id="selectfzr" parameterType="map" resultType="map">
		select peop_code AS "peop_code",peop_name||'('||peop_code||')' AS "peop_name"
		from peop_tab
 	</select>
 	
 	<select id="selectSSBM" parameterType="map" resultType="map">
		select dept_code AS "dept_code",dept_name AS "dept_name" 
		from dept_tab where dept_lv=1
 	</select>
 	
 	<select id="selectBH" parameterType="map" resultType="map">
		select NVL(max(net_code)+1,CONCAT(#{s_code},'01')) AS "bh"
    	from net_tab
		where s_code=#{s_code}
 	</select> 
 	<select id="selectJSWD" parameterType="map" resultType="map">
		select net_code AS "net_code",net_name AS "net_name"
	    from net_tab
	    where sjwd=0 and dqzt=0
 	</select>
 	<!-- 默认地区 -->
 	<!-- <select id="selectDQ" parameterType="map" resultType="map">
 		select code "code",name "name" from area_tab where 1=1
 	</select>
 	 -->
 	<select id="selectDQ" parameterType="map" resultType="map">
	  select code "code",name "name",net_code "net_code",s_code "s_code",name3 "jc",dqxx02 "dqxx02" from (select a.code,a.name,a.net_code,a.s_code,a.name3,(select name from area_tab where code=a.s_code) dqxx02 from area_tab a 
	  where (a.area_lv in (2,3)
	  or (a.area_lv=4 and a.sjbj=1))
		<if test="code != '' and code != null"> AND a.code =#{code}</if>
		<if test="q != '' and q != null"> AND a.name like '%'||#{q}||'%'</if>
		ORDER BY a.area_lv
		)
		where rownum&lt;200
 	</select> 
 	
 	<!-- 网点类别 -->
 	<select id="selectLB" parameterType="map" resultType="map">
 		select name "code",name "name" from  wdlb_tab where 1=1
 	</select>
 	
 	<select id="selectWDTree" parameterType="map" resultType="map">
		select a.net_code AS "id",a.net_name AS "text" ,a.net_lv AS "net_lv",a.s_code AS "s_code",
	    (select count(1) from net_tab where s_code=a.net_code) AS "mjbj"
	    from net_tab a
	    where 1=1
		<if test="lv != '' and lv != null">AND a.net_lv =#{lv}</if>
		<if test="s_code != '' and s_code != null">AND a.s_code =#{s_code}</if>
 	</select>
</mapper> 