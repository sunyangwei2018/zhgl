<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CFAWD" >
	<!-- 查询运单 --> 
 	<select id="selectWD" parameterType="map" resultType="map">
		select a.net_code "id",a.net_name "text",a.s_code "s_code",a.net_lv "lv",(select count(1) from net_tab where s_code=a.net_code) "mjbj"
		from net_tab a
		where 1=1 and dqzt=0
		<if test="lv != '' and lv != null"> AND a.net_lv=#{lv}</if>
		<if test="s_code != '' and s_code != null">AND a.s_code=#{s_code}</if>
 	</select>  
 	
 	<select id="selectYD" parameterType="map" resultType="map">
	SELECT
		a.billno "billno",(select name from billzt_tab where code = a.state) "state",b.cus_code "cus_code",a.cusno "cusno",to_char(a.lrrq, 'yyyy-MM-dd HH24:mi:ss') "lrrq",
		to_char(a.postdate,'yyyy-MM-dd')"postdate",a.boxes "boxes",a.duals "duals",a.package "packages",a.volume "volume",(select name from hwlb_tab where code=b.hwlb)"hwlb",
		(select name From area_tab where code=a.postzone)"postzone",(select net_name from net_tab where net_code=a.postnet)"postnet",
		a.postaddr "postaddr",(select name From area_tab where code=a.acceptzone)"acceptzone",(select net_name from net_tab where net_code=a.acceptnet)"acceptnet",
		a.acceptaddr "acceptaddr",a.acceptman "acceptman",a.accepttel "accepttel",
		(case b.jjfs when 0 THEN
				'箱'
				 when 1 THEN
				'包'
				when 2 THEN
				'体积'
				when 3 THEN
				'重量'
		 END) "jjfs",b.smjz "smjz",a.bj_flag "bj_flag",b.bjfl "bjfl",b.bjfee "bjfee",(select name from fkfs_tab where code=b.fkfs)"fkfs",b.postfee "postfee",
		 b.slfee "slfee",b.thfee "thfee",b.ccfee "ccfee",b.totalprice "totalprice",a.memo "memo",a.lrr "lrr",(select net_name from net_tab where net_code=a.nownet)"nownet"
	FROM
		bill_current_tab a,
		billfee_current_tab b,
		bill_tab c
	WHERE
		a.billno = b.billno
		and a.billno = c.billno
		and a.lrr=#{CFRY01}
		and a.impl=1
 	</select>
 	
 	<select id="selectJSWD" parameterType="map" resultType="map">
		select net_code "code",net_name "name",s_code "s_code"
		from net_tab
		where sjwd = 0
 	</select>
 	
 	<select id="selectDDWD" parameterType="map" resultType="map">
		select net_code AS "code", net_name "name",s_code AS "s_code"
		from  net_tab
		where sjwd = 0 and dqzt=0
 	</select>
 	
 	<select id="selectHWLB" parameterType="map" resultType="map">
		select code "code",name "name" from hwlb_tab
 	</select>
 	

<!--  	<select id="selectGG" parameterType="map" resultType="map">
		select code "code",name "name" From gg_tab
 	</select> -->
	<select id="selectJJFS" parameterType="map" resultType="map">
		select code "code",name "name" From jjfs_tab
		where 1=1
		<if test="name !='' and name != null">and name = #{name}</if>
 	</select>
 	
 	<select id="selectDQ" parameterType="map" resultType="map">
	  select code "code",name "name",net_code "net_code",s_code "s_code",name3 "jc",dqxx02 "dqxx02" from (select a.code,a.name,a.net_code,a.s_code,a.name3,(select name from area_tab where code=a.s_code) dqxx02 from area_tab a where 
	  	(a.area_lv in (2,3)
	    or (a.area_lv=4 and a.sjbj=1))
		<if test="code != '' and code != null"> AND a.code =#{code}</if>
		<if test="q != '' and q != null"> AND a.name like '%'||#{q}||'%'</if>
		ORDER BY a.area_lv
		)
		where rownum&lt;200
 	</select>
 	
 	<!--查询客户信息  -->
	<select id="selectKH" parameterType="map" resultType="map">
		SELECT a.cus_code "cus_code",a.s_name "s_name",a.cus_name "cus_name",a.lxr "lxr",a.tel "tel",a.jswd "jswd",a.bjje "bjje",a.bjfl "bjfl",
		a.fkfs "fkfs",a.vol "vol",to_char(a.ksrq,'yyyy-MM-dd') "ksrq",a.addr "addr",a.skgs "skgs",a.hwlb "hwlb",
		a.jjfs "jjfs",a.gg "gg",a.bj_flag "bj_flag"
		from cust_tab a
		where 1 = 1 AND cus_code =#{cus_code}
 	</select>
 	
 	<select id="checkYD" parameterType="map" resultType="map">
 		SELECT billno "billno" FROM bill_tab where billno=#{billno} 
 	</select>
 	
 	<select id="selectGG" parameterType="map" resultType="map">
 		SELECT code "code",name "name" FROM GG_TAB
 	</select>
 	
</mapper> 